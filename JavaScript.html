// Helper: Convert PDF to Images (Balanced for Accuracy & Speed)
    async function convertPdfToImages(pdfBytes) {
        const loadingTask = pdfjsLib.getDocument({ data: pdfBytes });
        const pdf = await loadingTask.promise;
        const numPages = pdf.numPages;
        const images = [];
        
        for (let i = 1; i <= numPages; i++) {
            const page = await pdf.getPage(i);
            
            // --- BALANCED SETTINGS ---
            // Scale 2.0: Sharp enough for math symbols (exponents/subscripts)
            // Scale 3.0: Too big, causes crashes
            const scale = 2.0; 
            
            const viewport = page.getViewport({ scale: scale });
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.height = viewport.height;
            canvas.width = viewport.width;
            
            await page.render({ canvasContext: context, viewport: viewport }).promise;
            
            // Compress to 0.6 (60% quality)
            // This prevents "artifacts" that look like decimal points
            const dataUrl = canvas.toDataURL('image/jpeg', 0.6);
            images.push(dataUrl.split(',')[1]);
        }
        return images;
    }
